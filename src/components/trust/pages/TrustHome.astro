---
/**
 * TrustHome — Corporate home page with hero, trust badges,
 * services grid, stats, testimonials, and CTA.
 *
 * Professional, established, reliability-focused design.
 */
import type { CollectionEntry } from 'astro:content'
import { siteConfig } from '@lib/site-config'

interface Props {
  services: CollectionEntry<'services'>[]
  testimonials: CollectionEntry<'testimonials'>[]
}

const { services, testimonials } = Astro.props

const stats = [
  { target: '5000', suffix: '+', label: 'Homes Cleaned' },
  { target: '4.9', suffix: '/5', label: 'Average Rating', decimal: true },
  { target: '150', suffix: '+', label: '5-Star Reviews' },
  { target: '6', suffix: '+', label: 'Years of Service' },
]
---

<main data-page="home">
  {/* ── Hero ── */}
  <section class="hero">
    <div class="hero__inner">
      <div class="hero__content">
        <div class="hero__badge">
          <svg width="14" height="14" viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="M12 2L3 7v6c0 5.25 3.83 10.15 9 11.25C17.17 23.15 21 18.25 21 13V7l-9-5z" stroke="currentColor" stroke-width="2" fill="none"/><path d="M9 12l2 2 4-4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
          Trusted by 5,000+ Seattle Homeowners
        </div>
        <h1 class="hero__title">Professional Cleaning<br />You Can <em>Trust</em></h1>
        <p class="hero__subtitle">
          Licensed, insured, and background-checked. CleanSpark delivers dependable cleaning services with a 100% satisfaction guarantee.
        </p>
        <div class="hero__actions">
          <a href="/contact" class="btn btn--primary">Request Free Estimate</a>
          <a href="/services" class="btn btn--outline">View Our Services</a>
        </div>
      </div>
      <div class="hero__art" aria-hidden="true">
        <div class="shield">
          <div class="shield__body">
            <svg class="shield__icon" width="80" height="80" viewBox="0 0 24 24" fill="none">
              <path d="M12 2L3 7v6c0 5.25 3.83 10.15 9 11.25C17.17 23.15 21 18.25 21 13V7l-9-5z" fill="var(--color-accent)" opacity="0.2"/>
              <path d="M12 2L3 7v6c0 5.25 3.83 10.15 9 11.25C17.17 23.15 21 18.25 21 13V7l-9-5z" stroke="var(--color-primary)" stroke-width="1" fill="none"/>
              <path d="M9 12l2 2 4-4" stroke="var(--color-primary)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </div>
          <div class="shield__ring"></div>
          <div class="shield__dot shield__dot--1"></div>
          <div class="shield__dot shield__dot--2"></div>
          <div class="shield__dot shield__dot--3"></div>
          <div class="shield__accent shield__accent--1"></div>
          <div class="shield__accent shield__accent--2"></div>
        </div>
      </div>
    </div>
  </section>

  {/* ── Trust Badges ── */}
  <section class="badges reveal">
    <div class="container">
      <div class="badges__grid">
        <div class="badge-item">
          <div class="badge-item__icon">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="M12 2L3 7v6c0 5.25 3.83 10.15 9 11.25C17.17 23.15 21 18.25 21 13V7l-9-5z" stroke="currentColor" stroke-width="2" fill="none"/><path d="M9 12l2 2 4-4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
          </div>
          <div class="badge-item__text">
            <strong>Licensed & Insured</strong>
            <span>Full liability coverage</span>
          </div>
        </div>
        <div class="badge-item">
          <div class="badge-item__icon">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" aria-hidden="true"><circle cx="12" cy="8" r="4" stroke="currentColor" stroke-width="2"/><path d="M6 21v-2a4 4 0 014-4h4a4 4 0 014 4v2" stroke="currentColor" stroke-width="2"/><path d="M16 3.13a4 4 0 010 7.75" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>
          </div>
          <div class="badge-item__text">
            <strong>Background Checked</strong>
            <span>Every team member verified</span>
          </div>
        </div>
        <div class="badge-item">
          <div class="badge-item__icon">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" aria-hidden="true"><polygon points="12,2 15.09,8.26 22,9.27 17,14.14 18.18,21.02 12,17.77 5.82,21.02 7,14.14 2,9.27 8.91,8.26" stroke="currentColor" stroke-width="2" fill="none" stroke-linejoin="round"/></svg>
          </div>
          <div class="badge-item__text">
            <strong>5-Star Rated</strong>
            <span>150+ verified reviews</span>
          </div>
        </div>
        <div class="badge-item">
          <div class="badge-item__icon">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="M12 8v4l3 3" stroke="currentColor" stroke-width="2" stroke-linecap="round"/><circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/></svg>
          </div>
          <div class="badge-item__text">
            <strong>Satisfaction Guaranteed</strong>
            <span>Free re-clean within 24hrs</span>
          </div>
        </div>
      </div>
    </div>
  </section>

  {/* ── Featured Services ── */}
  <section class="section reveal">
    <div class="container">
      <h2 class="section__title">Our Most Popular Services</h2>
      <p class="section__subtitle">Professional cleaning tailored to your needs, delivered with care and precision.</p>
      <div class="svc-grid reveal-stagger">
        {services.map((service) => (
          <article class="svc-card">
            <h3 class="svc-card__name">{service.data.name}</h3>
            <p class="svc-card__text">{service.data.tagline}</p>
            {service.data.startingPrice && (
              <p class="svc-card__price">
                Starting at <strong>${service.data.startingPrice}</strong>
                <span class="svc-card__unit">{service.data.priceUnit}</span>
              </p>
            )}
            <a href={`/services#${service.data.slug}`} class="svc-card__link">
              Learn More
              <svg width="14" height="14" viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="M5 12h14M12 5l7 7-7 7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
            </a>
          </article>
        ))}
      </div>
    </div>
  </section>

  {/* ── Stats ── */}
  <section class="stats-section" id="trust-stats">
    <div class="stats__inner reveal reveal-stagger">
      {stats.map((stat) => (
        <div class="stat">
          <div
            class="stat__number"
            data-counter
            data-target={stat.target}
            data-suffix={stat.suffix}
            data-decimal={stat.decimal ? 'true' : undefined}
          >
            0
          </div>
          <div class="stat__label">{stat.label}</div>
        </div>
      ))}
    </div>
  </section>

  {/* ── Testimonials ── */}
  <section class="section section--surface reveal">
    <div class="container">
      <h2 class="section__title">What Our Clients Say</h2>
      <p class="section__subtitle">Real reviews from real customers across the Seattle area.</p>
      <div class="testi-grid reveal-stagger">
        {testimonials.map((t) => (
          <blockquote class="testi">
            <div class="testi__stars" role="img" aria-label={`${t.data.rating} out of 5 stars`}>
              {Array.from({ length: t.data.rating }).map(() => (
                <svg width="16" height="16" viewBox="0 0 24 24" fill="var(--color-accent)" aria-hidden="true"><polygon points="12,2 15.09,8.26 22,9.27 17,14.14 18.18,21.02 12,17.77 5.82,21.02 7,14.14 2,9.27 8.91,8.26"/></svg>
              ))}
            </div>
            <p class="testi__text">&ldquo;{t.data.text}&rdquo;</p>
            <footer class="testi__footer">
              <strong class="testi__author">{t.data.name}</strong>
              {t.data.location && <span class="testi__location">{t.data.location}</span>}
            </footer>
          </blockquote>
        ))}
      </div>
    </div>
  </section>

  {/* ── CTA ── */}
  <section class="cta reveal">
    <div class="container">
      <div class="cta__inner">
        <div class="cta__text-wrap">
          <h2 class="cta__title">Ready to Experience Professional Cleaning?</h2>
          <p class="cta__text">
            Join thousands of satisfied customers across {siteConfig.serviceAreas.slice(0, 4).join(', ')} and more.
          </p>
        </div>
        <div class="cta__actions">
          <a href="/contact" class="btn btn--white">Get Your Free Estimate</a>
          <a href={`tel:${siteConfig.phone}`} class="cta__phone">
            Or call {siteConfig.phone}
          </a>
        </div>
      </div>
    </div>
  </section>
</main>

{/* Stats counter animation */}
<script>
  function initTrustStatsCounter(): void {
    const statsSection = document.getElementById('trust-stats')
    if (!statsSection) return

    let counted = false
    const observer = new IntersectionObserver(
      (entries) => {
        entries.forEach((entry) => {
          if (entry.isIntersecting && !counted) {
            counted = true
            document.querySelectorAll<HTMLElement>('[data-counter]').forEach((el) => {
              const target = parseFloat(el.dataset.target || '0')
              if (isNaN(target)) return
              const suffix = el.dataset.suffix || ''
              const isDecimal = el.dataset.decimal === 'true'
              const duration = 1000
              const start = performance.now()

              function update(now: number): void {
                const elapsed = now - start
                const progress = Math.min(elapsed / duration, 1)
                const eased = 1 - Math.pow(1 - progress, 3)
                const current = isDecimal
                  ? (target * eased).toFixed(1)
                  : Math.floor(target * eased).toLocaleString()
                el.textContent = current + suffix
                if (progress < 1) requestAnimationFrame(update)
              }

              requestAnimationFrame(update)
            })
          }
        })
      },
      { threshold: 0.3 },
    )

    observer.observe(statsSection)
  }

  initTrustStatsCounter()
</script>

<style>
  /* ═══════════════ HERO ═══════════════ */
  .hero {
    background: var(--color-surface);
    padding: 5rem 0 4rem;
    border-bottom: 1px solid #DEE2E6;
  }

  .hero__inner {
    max-width: var(--container-max);
    margin: 0 auto;
    padding: 0 2rem;
    display: grid;
    grid-template-columns: 1.15fr 0.85fr;
    gap: 4rem;
    align-items: center;
  }

  .hero__badge {
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    font-family: var(--font-body);
    font-weight: 600;
    font-size: 0.8125rem;
    color: var(--color-primary);
    background: color-mix(in srgb, var(--color-primary) 8%, transparent);
    padding: 0.4rem 1rem;
    border-radius: var(--radius-full);
    margin-bottom: 1.5rem;
  }

  .hero__title {
    font-family: var(--font-heading);
    font-weight: 700;
    font-size: clamp(2.25rem, 5vw, 3.5rem);
    line-height: 1.15;
    color: var(--color-primary);
    margin-bottom: 1.25rem;
  }

  .hero__title em {
    font-style: normal;
    color: var(--color-secondary);
  }

  .hero__subtitle {
    font-family: var(--font-body);
    font-size: clamp(1rem, 1.5vw, 1.125rem);
    color: var(--color-text-muted);
    max-width: 520px;
    line-height: 1.7;
    margin-bottom: 2rem;
  }

  .hero__actions {
    display: flex;
    gap: 1rem;
    flex-wrap: wrap;
  }

  /* ── Shield art ── */
  .hero__art {
    display: flex;
    align-items: center;
    justify-content: center;
    min-height: 360px;
  }

  .shield {
    position: relative;
    width: 280px;
    height: 280px;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .shield__body {
    width: 160px;
    height: 160px;
    border-radius: 50%;
    background: color-mix(in srgb, var(--color-primary) 6%, white);
    border: 2px solid color-mix(in srgb, var(--color-primary) 15%, transparent);
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 2;
    position: relative;
  }

  .shield__ring {
    position: absolute;
    width: 240px;
    height: 240px;
    border-radius: 50%;
    border: 1.5px dashed color-mix(in srgb, var(--color-secondary) 30%, transparent);
    animation: trustSpin 30s linear infinite;
  }

  .shield__dot {
    position: absolute;
    width: 10px;
    height: 10px;
    border-radius: 50%;
    background: var(--color-secondary);
  }

  .shield__dot--1 { top: 10%; right: 15%; opacity: 0.6; }
  .shield__dot--2 { bottom: 20%; left: 10%; opacity: 0.4; width: 8px; height: 8px; }
  .shield__dot--3 { top: 50%; right: 5%; opacity: 0.3; width: 6px; height: 6px; }

  .shield__accent {
    position: absolute;
    border-radius: var(--radius-md);
    background: color-mix(in srgb, var(--color-accent) 15%, transparent);
    border: 1px solid color-mix(in srgb, var(--color-accent) 25%, transparent);
  }

  .shield__accent--1 {
    width: 60px;
    height: 60px;
    top: 5%;
    left: 5%;
    transform: rotate(15deg);
  }

  .shield__accent--2 {
    width: 40px;
    height: 40px;
    bottom: 10%;
    right: 10%;
    transform: rotate(-10deg);
  }

  @keyframes trustSpin {
    to { transform: rotate(360deg); }
  }

  /* ═══════════════ BUTTONS ═══════════════ */
  .btn {
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    font-family: var(--font-body);
    font-weight: 600;
    font-size: 0.9375rem;
    padding: 0.8rem 1.75rem;
    border-radius: var(--radius-md);
    text-decoration: none;
    transition: all 0.2s ease;
  }

  .btn--primary {
    background: var(--color-cta);
    color: var(--color-cta-text);
    box-shadow: 0 2px 8px rgba(27, 73, 101, 0.2);
  }

  .btn--primary:hover {
    background: var(--color-secondary);
    box-shadow: 0 4px 16px rgba(27, 73, 101, 0.25);
    transform: translateY(-1px);
  }

  .btn--outline {
    color: var(--color-primary);
    border: 2px solid var(--color-primary);
    background: transparent;
  }

  .btn--outline:hover {
    background: var(--color-primary);
    color: white;
  }

  .btn--white {
    background: white;
    color: var(--color-primary);
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
  }

  .btn--white:hover {
    transform: translateY(-1px);
    box-shadow: 0 4px 16px rgba(0, 0, 0, 0.12);
  }

  /* ═══════════════ SHARED ═══════════════ */
  .container {
    max-width: var(--container-max);
    margin: 0 auto;
    padding: 0 2rem;
  }

  .section {
    padding: var(--section-padding) 0;
  }

  .section--surface {
    background: var(--color-surface);
  }

  .section__title {
    font-family: var(--font-heading);
    font-weight: 700;
    font-size: clamp(1.75rem, 3vw, 2.25rem);
    color: var(--color-primary);
    text-align: center;
    margin-bottom: 0.75rem;
  }

  .section__subtitle {
    font-family: var(--font-body);
    color: var(--color-text-muted);
    text-align: center;
    font-size: 1.0625rem;
    max-width: 560px;
    margin: 0 auto 3rem;
    line-height: 1.6;
  }

  /* ═══════════════ TRUST BADGES ═══════════════ */
  .badges {
    padding: 3rem 0;
    background: var(--color-background);
  }

  .badges__grid {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 1.5rem;
  }

  .badge-item {
    display: flex;
    align-items: flex-start;
    gap: 0.75rem;
    padding: 1.25rem;
    background: var(--color-surface);
    border-radius: var(--radius-md);
    border: 1px solid #DEE2E6;
    transition: border-color 0.2s, box-shadow 0.2s;
  }

  .badge-item:hover {
    border-color: var(--color-secondary);
    box-shadow: 0 2px 12px rgba(27, 73, 101, 0.08);
  }

  .badge-item__icon {
    flex-shrink: 0;
    width: 40px;
    height: 40px;
    border-radius: 50%;
    background: color-mix(in srgb, var(--color-primary) 8%, transparent);
    color: var(--color-primary);
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .badge-item__text {
    display: flex;
    flex-direction: column;
    gap: 0.125rem;
  }

  .badge-item__text strong {
    font-family: var(--font-body);
    font-size: 0.9375rem;
    font-weight: 600;
    color: var(--color-text);
  }

  .badge-item__text span {
    font-size: 0.8125rem;
    color: var(--color-text-muted);
  }

  /* ═══════════════ SERVICES ═══════════════ */
  .svc-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 1.5rem;
  }

  .svc-card {
    background: var(--color-surface);
    border: 1px solid #DEE2E6;
    border-radius: var(--radius-md);
    padding: 2rem;
    transition: transform 0.2s, box-shadow 0.2s;
  }

  .svc-card:hover {
    transform: translateY(-4px);
    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.08);
  }

  .svc-card__name {
    font-family: var(--font-heading);
    font-weight: 700;
    font-size: 1.25rem;
    color: var(--color-primary);
    margin-bottom: 0.5rem;
  }

  .svc-card__text {
    font-family: var(--font-body);
    color: var(--color-text-muted);
    font-size: 0.9375rem;
    line-height: 1.6;
    margin-bottom: 1rem;
  }

  .svc-card__price {
    font-family: var(--font-body);
    color: var(--color-text);
    font-size: 0.9375rem;
    margin-bottom: 1rem;
  }

  .svc-card__price strong {
    color: var(--color-primary);
    font-size: 1.0625rem;
  }

  .svc-card__unit {
    color: var(--color-text-muted);
    font-size: 0.8125rem;
  }

  .svc-card__link {
    display: inline-flex;
    align-items: center;
    gap: 0.375rem;
    font-family: var(--font-body);
    font-weight: 600;
    font-size: 0.875rem;
    color: var(--color-text-muted);
    text-decoration: none;
    transition: gap 0.2s;
  }

  .svc-card__link:hover {
    gap: 0.625rem;
  }

  /* ═══════════════ STATS ═══════════════ */
  .stats-section {
    background: var(--color-primary);
    padding: 3.5rem 0;
  }

  .stats__inner {
    max-width: var(--container-max);
    margin: 0 auto;
    padding: 0 2rem;
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 2rem;
    text-align: center;
  }

  .stat__number {
    font-family: var(--font-heading);
    font-weight: 700;
    font-size: clamp(2rem, 3.5vw, 2.75rem);
    color: white;
    line-height: 1.2;
    margin-bottom: 0.25rem;
  }

  .stat__label {
    font-family: var(--font-body);
    font-size: 0.875rem;
    color: rgba(255, 255, 255, 0.75);
    font-weight: 600;
  }

  /* ═══════════════ TESTIMONIALS ═══════════════ */
  .testi-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 1.5rem;
  }

  .testi {
    background: var(--color-background);
    border: 1px solid #DEE2E6;
    border-radius: var(--radius-md);
    padding: 2rem;
    margin: 0;
    border-left: 4px solid var(--color-secondary);
    transition: transform 0.2s, box-shadow 0.2s;
  }

  .testi:hover {
    transform: translateY(-3px);
    box-shadow: 0 4px 16px rgba(0, 0, 0, 0.06);
  }

  .testi__stars {
    display: flex;
    gap: 2px;
    margin-bottom: 1rem;
  }

  .testi__text {
    font-family: var(--font-body);
    color: var(--color-text);
    font-size: 1rem;
    line-height: 1.7;
    margin-bottom: 1.25rem;
    font-style: italic;
  }

  .testi__footer { font-style: normal; }

  .testi__author {
    font-family: var(--font-body);
    font-weight: 600;
    color: var(--color-primary);
    font-size: 0.9375rem;
    display: block;
  }

  .testi__location {
    color: var(--color-text-muted);
    font-size: 0.8125rem;
  }

  /* ═══════════════ CTA ═══════════════ */
  .cta {
    background: var(--color-primary);
    padding: 4rem 0;
  }

  .cta__inner {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 3rem;
  }

  .cta__title {
    font-family: var(--font-heading);
    font-weight: 700;
    font-size: clamp(1.5rem, 3vw, 2rem);
    color: white;
    margin-bottom: 0.5rem;
  }

  .cta__text {
    color: rgba(255, 255, 255, 0.8);
    font-size: 1rem;
    line-height: 1.6;
  }

  .cta__actions {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 0.75rem;
    flex-shrink: 0;
  }

  .cta__phone {
    color: rgba(255, 255, 255, 0.8);
    font-size: 0.875rem;
    text-decoration: none;
    transition: color 0.2s;
  }

  .cta__phone:hover { color: white; }

  /* ═══════════════ RESPONSIVE ═══════════════ */
  @media (max-width: 1024px) {
    .hero__inner {
      grid-template-columns: 1fr;
      text-align: center;
      gap: 2rem;
    }

    .hero__subtitle { margin: 0 auto 2rem; }
    .hero__actions { justify-content: center; }
    .hero__art { min-height: 240px; }
    .shield { width: 220px; height: 220px; }
    .shield__body { width: 120px; height: 120px; }
    .shield__ring { width: 190px; height: 190px; }
  }

  @media (max-width: 768px) {
    .hero { padding: 3rem 0 2rem; }

    .badges__grid {
      grid-template-columns: 1fr 1fr;
    }

    .stats__inner {
      grid-template-columns: 1fr 1fr;
      gap: 1.5rem;
    }

    .cta__inner {
      flex-direction: column;
      text-align: center;
    }
  }

  @media (max-width: 480px) {
    .badges__grid {
      grid-template-columns: 1fr;
    }

    .stats__inner {
      grid-template-columns: 1fr 1fr;
    }
  }
</style>
