---
export const prerender = false

import { getCollection } from 'astro:content'
import { resolveLayout } from '@lib/theme-resolver'
import { resolvePageContent } from '@lib/page-resolver'

const themeId = Astro.locals.theme
const Layout = resolveLayout(themeId)
const PageContent = resolvePageContent(themeId, 'gallery')

const galleryItems = await getCollection('gallery')
const sorted = galleryItems.sort((a, b) => a.data.displayOrder - b.data.displayOrder)
const uniqueServices = [...new Set(galleryItems.map((item) => item.data.service))]
---

<Layout
  title="Gallery"
  description="See the CleanSpark difference. Before-and-after photos from real cleaning projects in the Seattle area."
>
  <PageContent gallery={sorted} uniqueServices={uniqueServices} />
</Layout>
